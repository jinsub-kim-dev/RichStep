package com.erving.richstep.mock

import com.erving.richstep.domain.user.domain.User
import com.erving.richstep.domain.user.service.port.UserRepository

class FakeUserRepository : UserRepository {

    private var autoGeneratedId: Long = 1L
    private val data: MutableList<User> = mutableListOf()

    private fun getIdAfterIncrement(): Long {
        return this.autoGeneratedId++
    }

    override fun save(user: User): User {
        if (user.id == null) {
            user.id = this.getIdAfterIncrement()
        } else {
            data.removeIf { it.id == user.id }
        }

        this.data.add(user)
        return user
    }


    override fun findById(id: Long): User? {
        return this.data.find { it.id == id }
    }
}